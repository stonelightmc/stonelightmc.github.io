<!DOCTYPE html>
<html lang="en">

<head>
    <title>&#12300;Stonelight&#12301;</title>
    <!--<link rel="canonical" href="https://stonelightmc.github.io/places.html">-->
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="styles_places.css">
    <meta name="viewport" content="width=device-width; initial-scale=1">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-42DLHBGV89"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-42DLHBGV89');
    </script>
</head>

<body>
    <header>
        <div id="rHeader">
            <div style="justify-content: flex-start;">
                <img src="img/logo.webp" height="80">
                <span style="font-size: 25px; color: #4596ff;" class="hide_on_phone">StoneLight</span>
            </div>
            <div id="pages">
                <a href="/index.html">Главная</a>
                <a href="/places.html">Постройки</a>
                <a href="/klans.html" class="checked">Кланы</a>
            </div>
            <div style="justify-content: flex-end;">
                <span class="NoRuBy hide_on_phone" onclick="hidenoruby()"><span id="nohover">Сервер недоступен на территории России и Беларуси</span><div id="onhover"><span>Закрыть</span></div></span>
            </div>
        </div>
    </header>
    <div id="places-desc">
        <span id="mainD">Постройки</span>
    </div>
     <div id="places">
    </div>
    <div id="modal" class="hide">
        <div id="modal-content">
            <div id="playerList">
                <span style="margin-bottom: 5px; font-size: larger;">Участники</span>
            </div>
            <div class="close" onclick="closeTrades()"></div>
        </div>
        <div id="blacker"></div>
    </div>
    <script>
        var json;
        var skins = ["DedKob", "Uniritial", "ArchTeese", "FunnyVanya", "Yan_Gaming"];
        window.onload = loadContent;
        function closeTrades() {
            document.getElementById("playerList").innerHTML = "<span style=\"margin-bottom: 5px; font-size: larger;\">Участники</span>";
            document.getElementById("modal").classList.add("hide");
        }
        function viewTrades() {
                var players;
                json.forEach(element => {
                    if(element["name"] == event.currentTarget.parentElement.children[0].innerHTML) {
                        players = element["players"];
                    }
                });
                players.forEach(element => {
                    document.getElementById("playerList").appendChild(createPlayer(element));
                })
                document.getElementById("modal").classList.remove("hide");
      }
        function createPlayer(nickname) {
          var out = document.createElement("div");
          out.classList.add("playerBorder");
          var temp = document.createElement("img");
          if(skins.includes(nickname)) {
            temp.src = "/img/skins/" + nickname + ".webp";
          } else {
            temp.src = "/img/noskin.webp";
          }
          temp.style.verticalAlign = "middle";
          out.appendChild(temp);
          temp = document.createElement("span");
          temp.textContent = nickname;
          temp.style.verticalAlign = "middle";
          out.appendChild(temp);
          return out;
        }
        function loadContent() {
            var xhr = new XMLHttpRequest();
            xhr.open('GET', 'klans.json', false);
            xhr.send();
            if (xhr.status != 200) {
                alert(xhr.status + ': ' + xhr.statusText);
            } else {
                json = JSON.parse(xhr.responseText)["klans"];
                for (let i = 0; i < json.length; i++) {
                    var out = document.createElement("div");
                    out.classList.add("place");
                    var temp = document.createElement("div");
                    temp.textContent = json[i]["name"];
                    out.appendChild(temp);
                    temp = document.createElement("div");
                    temp.textContent = json[i]["desc"];
                    temp.style.color = "#777";
                    out.appendChild(temp);
                    temp = document.createElement("div");
                    temp.textContent = "Игроки в клане (" + json[i]["players"].length + ")";
                    temp.style.color = "#0000ff";
                    temp.style.cursor = "pointer";
                    temp.onclick = viewTrades;
                    out.appendChild(temp);
                    temp = document.createElement("div");
                    temp.innerHTML = "<span style=\"vertical-align: middle\">Глава: </span>";
                    let tempPlayer = createPlayer(json[i]["owner"]);
                    tempPlayer.style.display = "inline-block";
                    temp.appendChild(tempPlayer);
                    out.appendChild(temp);
                    document.getElementById("places").appendChild(out);
                }
            }
        }
    </script>
</body>